<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>query</title>
  </head>
  <body>
    <script>
      let treeIdMap = new Map();
      let res = {
        code: 200,
        message: "成功",
        content: [
          {
            level: 0,
            columnList: [
              {
                level: 0,
                updateTime: 1671429628695,
                authorId: 4,
                title: "水资源",
                type: 0,
                content: "浦东审计-预设模型-水资源",
                parentId: 84,
                createTime: 1671429628695,
                authorName: "user001",
                id: 86,
                state: 0,
                tag: "pdsj_szy",
              },
              {
                level: 0,
                updateTime: 1671429574939,
                authorId: 4,
                title: "土地资源",
                type: 0,
                content: "浦东审计-预设模型-土地资源",
                parentId: 84,
                createTime: 1671429574939,
                authorName: "user001",
                id: 85,
                state: 0,
                tag: "ysmx_tdzy",
              },
            ],
            updateTime: 1671429517134,
            authorId: 4,
            title: "预设模型",
            type: 0,
            content: "预设模型",
            parentId: -1,
            createTime: 1671429517134,
            authorName: "user001",
            id: 84,
            state: 0,
            tag: "pdsj_ysmx",
          },
          {
            level: 0,
            columnList: [
              {
                level: 0,
                columnList: [
                  {
                    level: 0,
                    columnList: [
                      {
                        level: 0,
                        modelId: 85,
                        updateTime: 1671000476142,
                        authorId: 4,
                        title: "河道资源",
                        type: 1,
                        content: "河道资源",
                        parentId: 71,
                        modelName: "dtz_shui_hedao_m_pdsj_shui",
                        createTime: 1671000476142,
                        authorName: "user001",
                        id: 80,
                        state: 0,
                        tag: "dtz_shui_hedao",
                      },
                      {
                        level: 0,
                        modelId: 84,
                        updateTime: 1671000454017,
                        authorId: 4,
                        title: "水域数据",
                        type: 1,
                        content: "水域数据",
                        parentId: 71,
                        modelName: "dtz_shui_shuiyu_m_pdsj_shui",
                        createTime: 1671000454017,
                        authorName: "user001",
                        id: 79,
                        state: 0,
                        tag: "dtz_shui_shuiyu",
                      },
                    ],
                    updateTime: 1670998513989,
                    authorId: 4,
                    title: "水资源",
                    type: 0,
                    content: "水资源",
                    parentId: 69,
                    createTime: 1670998513989,
                    authorName: "user001",
                    id: 71,
                    state: 0,
                    tag: "dtz_shuiziyuan",
                  },
                  {
                    level: 0,
                    columnList: [
                      {
                        level: 0,
                        modelId: 82,
                        updateTime: 1671001514601,
                        authorId: 4,
                        title: "永久基本农田被占用",
                        type: 1,
                        content: "永久基本农田被占用",
                        parentId: 70,
                        modelName: "dtz_tudi_yjjbntbzy_m_pdsj_layer_tudi",
                        createTime: 1671000396932,
                        authorName: "user001",
                        id: 77,
                        state: 0,
                        tag: "dtz_tudi_yjjbntbzy",
                      },
                      {
                        level: 0,
                        modelId: 83,
                        updateTime: 1671000428603,
                        authorId: 4,
                        title: "储备土地资源",
                        type: 1,
                        content: "储备土地资源",
                        parentId: 70,
                        modelName: "dtz_tudi_cbtdzy_m_pdsj_layer_tudi",
                        createTime: 1671000428603,
                        authorName: "user001",
                        id: 78,
                        state: 0,
                        tag: "dtz_tudi_cbtdzy",
                      },
                    ],
                    updateTime: 1670998490019,
                    authorId: 4,
                    title: "土地资源",
                    type: 0,
                    content: "土地资源",
                    parentId: 69,
                    createTime: 1670998485920,
                    authorName: "user001",
                    id: 70,
                    state: 0,
                    tag: "dtz_tudi",
                  },
                ],
                updateTime: 1670997868914,
                authorId: 4,
                title: "大团镇",
                type: 0,
                content: "浦东审计项目大团镇",
                parentId: 62,
                createTime: 1670997868914,
                authorName: "user001",
                id: 69,
                state: 0,
                tag: "datuanzhen",
              },
              {
                level: 0,
                columnList: [
                  {
                    level: 0,
                    columnList: [
                      {
                        level: 0,
                        modelId: 81,
                        updateTime: 1671000359881,
                        authorId: 4,
                        title: "河道数据",
                        type: 1,
                        content: "河道数据",
                        parentId: 72,
                        modelName: "zjz_shui_hedao_m_pdsj_shui",
                        createTime: 1671000359881,
                        authorName: "user001",
                        id: 76,
                        state: 0,
                        tag: "zjz_shui_hedao",
                      },
                      {
                        level: 0,
                        modelId: 80,
                        updateTime: 1671000325902,
                        authorId: 4,
                        title: "水域数据",
                        type: 1,
                        content: "水域数据",
                        parentId: 72,
                        modelName: "zjz_shui_shuiyu_m_pdsj_shui",
                        createTime: 1671000325902,
                        authorName: "user001",
                        id: 75,
                        state: 0,
                        tag: "zjz_shui_shuiyu",
                      },
                    ],
                    updateTime: 1670998536524,
                    authorId: 4,
                    title: "水资源",
                    type: 0,
                    content: "水资源",
                    parentId: 63,
                    createTime: 1670998536524,
                    authorName: "user001",
                    id: 72,
                    state: 0,
                    tag: "zjz_shuiziyuan",
                  },
                  {
                    level: 0,
                    columnList: [
                      {
                        level: 0,
                        modelId: 86,
                        updateTime: 1671001664059,
                        authorId: 4,
                        title: "永久基本农田被占用",
                        type: 1,
                        content: "永久基本农田被占用",
                        parentId: 64,
                        modelName: "zjz_tudi_yjjbntbzy_m_pdsj_layer_tudi",
                        createTime: 1671001664059,
                        authorName: "user001",
                        id: 81,
                        state: 0,
                        tag: "zjz_tudi_yjjbntbzy",
                      },
                      {
                        level: 0,
                        modelId: 79,
                        updateTime: 1671000279594,
                        authorId: 4,
                        title: "储备土地资源",
                        type: 1,
                        content: "储备土地资源",
                        parentId: 64,
                        modelName: "zjz_tudi_cbtdzy_m_pdsj_layer_tudi",
                        createTime: 1671000279594,
                        authorName: "user001",
                        id: 74,
                        state: 0,
                        tag: "zjz_tudi_cbtdzy",
                      },
                    ],
                    updateTime: 1670832744486,
                    authorId: 4,
                    title: "土地",
                    type: 0,
                    content: "土地图层",
                    parentId: 63,
                    createTime: 1670832744486,
                    authorName: "user001",
                    id: 64,
                    state: 0,
                    tag: "tudi",
                  },
                ],
                updateTime: 1670832719502,
                authorId: 4,
                title: "张江镇",
                type: 0,
                content: "张江镇图层",
                parentId: 62,
                createTime: 1670832719502,
                authorName: "user001",
                id: 63,
                state: 0,
                tag: "zhangjiangzhen",
              },
            ],
            updateTime: 1670832690073,
            authorId: 4,
            title: "所有图层",
            type: 0,
            content: "我就是个测试栏目",
            parentId: -1,
            createTime: 1670832660851,
            authorName: "user001",
            id: 62,
            state: 0,
            tag: "test_cc",
          },
          {
            level: 2,
            modelId: 21,
            updateTime: 1667381272142,
            title: "front测试sso",
            type: 1,
            content: "ssss",
            parentId: -1,
            modelName: "test_all_test_all",
            createTime: 1665300034369,
            id: 19,
            state: 0,
            tag: "test_all",
          },
          {
            level: 0,
            columnList: [
              {
                level: 0,
                modelId: 90,
                updateTime: 1671189106282,
                authorId: 1,
                title: "系统信息",
                type: 1,
                content: "浦东新区智慧审计平台专用",
                parentId: 48,
                modelName: "system_info",
                createTime: 1671189106282,
                authorName: "super_user",
                id: 83,
                state: 0,
                tag: "system",
              },
              {
                level: 0,
                modelId: 76,
                updateTime: 1670996446859,
                authorId: 4,
                title: "地图底图服务",
                type: 1,
                content: "地图底图服务",
                parentId: 48,
                modelName: "c_image_m_image",
                createTime: 1670996446859,
                authorName: "user001",
                id: 68,
                state: 0,
                tag: "c_image",
              },
              {
                level: 0,
                modelId: 74,
                updateTime: 1670989411967,
                authorId: 4,
                title: "消息提醒",
                type: 1,
                content: "浦东审计消息提醒",
                parentId: 48,
                modelName: "c_message_m_message",
                createTime: 1670989411967,
                authorName: "user001",
                id: 67,
                state: 0,
                tag: "c_message",
              },
              {
                level: 0,
                modelId: 71,
                updateTime: 1670829709536,
                authorId: 1,
                title: "我的任务",
                type: 1,
                content: "任务表",
                parentId: 48,
                modelName: "task_T_SH_SJJ_TASK",
                createTime: 1670829709536,
                authorName: "super_user",
                id: 61,
                state: 0,
                tag: "task",
              },
              {
                level: 0,
                modelId: 70,
                updateTime: 1670829682135,
                authorId: 1,
                title: "全流程管理",
                type: 1,
                content: "项目表",
                parentId: 48,
                modelName: "project_T_SH_SJJ_PROJECT",
                createTime: 1670829682135,
                authorName: "super_user",
                id: 60,
                state: 0,
                tag: "project",
              },
              {
                level: 0,
                modelId: 67,
                updateTime: 1670293142407,
                authorId: 1,
                title: "新法律法规",
                type: 1,
                content: "新法律法规",
                parentId: 48,
                modelName: "flfg_new_sh_flfg",
                createTime: 1670293142407,
                authorName: "super_user",
                id: 58,
                state: 0,
                tag: "flfg_new",
              },
              {
                level: 0,
                modelId: 66,
                updateTime: 1670229164311,
                authorId: 1,
                title: "频发问题",
                type: 1,
                content: "频发问题",
                parentId: 48,
                modelName: "pfwt_sh_pfwt",
                createTime: 1670229164311,
                authorName: "super_user",
                id: 57,
                state: 0,
                tag: "pfwt",
              },
            ],
            updateTime: 1667198344478,
            title: "浦东审计",
            type: 0,
            content: "浦东审计-栏目",
            parentId: -1,
            createTime: 1667198344478,
            id: 48,
            state: 0,
            tag: "puDong_audit",
          },
          {
            level: 0,
            columnList: [
              {
                level: 0,
                modelId: 44,
                updateTime: 1665644487406,
                title: "EWFEW",
                type: 1,
                content: "EWFEW",
                parentId: 34,
                modelName: "EFE_test_all",
                createTime: 1665644487406,
                id: 35,
                state: 0,
                tag: "EFE",
              },
            ],
            updateTime: 1665644458871,
            title: "CWVWE",
            type: 0,
            content: "EWFE",
            parentId: -1,
            createTime: 1665644458871,
            id: 34,
            state: 0,
            tag: "二维法国人个人",
          },
          {
            postIcon: "",
            level: 2,
            modelId: 43,
            updateTime: 1665383568930,
            authorId: 186,
            title: "内容栏目-测试-栏目",
            type: 1,
            content: "测试-内容栏目",
            parentId: -1,
            modelName:
              "import_contentColumn2_model_test_aa8e6_contentColumn2_model_test",
            createTime: 1665383568930,
            authorName: "张三",
            frontIcon: "",
            id: 33,
            state: 0,
            tag: "import_contentColumn2_model_test_aa8e6",
          },
          {
            postIcon: "",
            level: 2,
            modelId: 23,
            updateTime: 1665300202397,
            title: "内容栏目-测试导出-栏目",
            type: 1,
            content: "测试-内容栏目",
            parentId: -1,
            modelName: "shape_data_point_test_model_point",
            createTime: 1665300202397,
            frontIcon: "",
            id: 20,
            state: 0,
            tag: "shape_data_point",
          },
          {
            postIcon: "",
            level: 0,
            modelId: 18,
            updateTime: 1665299002831,
            title: "内容栏目-测试-栏目",
            type: 1,
            content: "测试-内容栏目",
            parentId: -1,
            modelName: "contentColumn2_model_test",
            createTime: 1665299002831,
            frontIcon: "",
            id: 18,
            state: 0,
            tag: "contentColumn2",
          },
        ],
      };

      let modelData = [];

      if (res.code === 200 && res.content.length > 0) {
        let data = res.content.map((item1) => {
          if (item1.title === "所有图层" && item1.columnList.length > 0) {
            treeIdMap.set(
              `${item1.title}_${item1.id}`,
              `${item1.title}_${item1.id}`
            );
            return {
              id: item1.id,
              label: item1.title,
              // 镇
              children:
                item1.columnList.length === 0
                  ? []
                  : item1.columnList.map((item2) => {
                      treeIdMap.set(
                        `${item2.title}_${item2.id}`,
                        `${item2.title}_${item2.id}`
                      );
                      return {
                        id: item2.id,
                        label: item2.title,
                        // 水资源，土地资源，林地资源
                        children:
                          item2.columnList.length === 0
                            ? []
                            : item2.columnList.map((item3) => {
                                treeIdMap.set(
                                  item3.id,
                                  `${item3.title}_${item3.id}`
                                );
                                return {
                                  id: item3.id,
                                  label: item3.title,
                                  tag: item3.tag,
                                  children:
                                    item3.columnList.length === 0
                                      ? []
                                      : item3.columnList.map((item4) => {
                                          treeIdMap.set(
                                            item4.id,
                                            `${item4.title}_${item4.id}`
                                          );
                                          return {
                                            id: item4.id,
                                            label: item4.title,
                                            children: [],
                                            modelName: item4.modelName,
                                            modelId: item4.modelId,
                                            tag: item4.tag,
                                          };
                                        }),
                                };
                              }),
                      };
                    }),
            };
          }

          if (item1.title === "预设模型" && item1.columnList.length > 0) {
            treeIdMap.set(item1.title, `${item1.title}_${item1.id}`);
            return {
              id: item1.id,
              label: item1.title,
              children:
                item1.columnList.length === 0
                  ? []
                  : item1.columnList.map((item2) => {
                      treeIdMap.set(item2.title, `${item2.title}_${item2.id}`);
                      return {
                        id: item2.id,
                        label: item2.title,
                        children: [],
                      };
                    }),
            };
          }
        });

        modelData = [data[0], data[1]];
      }

      console.log(modelData);
    </script>
  </body>
</html>
